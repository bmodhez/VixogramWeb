<div class="hidden" data-notif-unread="{{ unread_count|default:0 }}"></div>

{% if notifications %}
    <div class="space-y-2">
        {% for n in notifications %}
            <a
                href="{{ n.url|default:'#' }}"
                class="block rounded-xl border border-gray-800 bg-gray-900/60 hover:bg-gray-900/80 transition px-3 py-2"
                data-notif-id="{{ n.id }}"
                data-notif-read="{% if n.is_read %}1{% else %}0{% endif %}"
                data-notif-mark-url="{% url 'notifications-mark-read' n.id %}"
            >
                <div class="flex items-start gap-2">
                    <div data-notif-dot class="mt-1 h-2 w-2 rounded-full {% if n.is_read %}bg-gray-600{% else %}bg-emerald-400{% endif %}"></div>
                    <div class="min-w-0 flex-1">
                        <div class="text-xs text-gray-200">
                            {% if n.type == 'follow' %}Follow{% elif n.type == 'reply' %}Reply{% elif n.type == 'mention' %}Mention{% else %}Notification{% endif %}
                            {% if n.from_user %}<span class="text-gray-400"> â€¢ @{{ n.from_user.username }}</span>{% endif %}
                        </div>
                        {% if n.preview %}<div class="text-[11px] text-gray-300 truncate mt-1">{{ n.preview }}</div>{% endif %}
                        <div class="text-[10px] text-gray-500 mt-1">{{ n.created }}</div>
                    </div>
                </div>
            </a>
        {% endfor %}
    </div>
{% else %}
    <div class="text-xs text-gray-400">No notifications.</div>
{% endif %}

<div class="mt-3 flex items-center justify-end">
    <div class="flex items-center gap-2">
        <form method="post" action="{% url 'notifications-clear-all' %}" hx-post="{% url 'notifications-clear-all' %}" hx-target="#notif_dropdown_body" hx-swap="innerHTML">
            {% csrf_token %}
            <button type="submit" class="text-xs bg-gray-700 hover:bg-gray-600 text-white px-3 py-1.5 rounded-lg transition-colors">Clear all</button>
        </form>
        <form method="post" action="{% url 'notifications-read-all' %}" hx-post="{% url 'notifications-read-all' %}" hx-target="#notif_dropdown_body" hx-swap="innerHTML">
            {% csrf_token %}
            <button type="submit" class="text-xs bg-gray-800 hover:bg-gray-700 text-white px-3 py-1.5 rounded-lg transition-colors">Mark all read</button>
        </form>
    </div>
</div>
